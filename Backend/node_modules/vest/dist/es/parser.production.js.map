{"version":3,"file":"parser.production.js","sources":["../../src/errors/ErrorStrings.ts","../../src/exports/parser.ts"],"sourcesContent":["export enum ErrorStrings {\n  HOOK_CALLED_OUTSIDE = 'hook called outside of a running suite.',\n  EXPECTED_VEST_TEST = 'Expected value to be an instance of IsolateTest',\n  FIELD_NAME_REQUIRED = 'Field name must be passed',\n  SUITE_MUST_BE_INITIALIZED_WITH_FUNCTION = 'Suite must be initialized with a function',\n  PROMISIFY_REQUIRE_FUNCTION = 'Vest.Promisify must be called with a function',\n  PARSER_EXPECT_RESULT_OBJECT = \"Vest parser: expected argument at position 0 to be Vest's result object.\",\n  WARN_MUST_BE_CALLED_FROM_TEST = 'Warn must be called from within the body of a test function',\n  EACH_CALLBACK_MUST_BE_A_FUNCTION = 'Each must be called with a function',\n  INVALID_PARAM_PASSED_TO_FUNCTION = 'Incompatible params passed to {fn_name} function. \"{param}\" must be of type {expected}',\n  TESTS_CALLED_IN_DIFFERENT_ORDER = `Vest Critical Error: Tests called in different order than previous run.\n    expected: {fieldName}\n    received: {prevName}\n    This can happen on one of two reasons:\n    1. You're using if/else statements to conditionally select tests. Instead, use \"skipWhen\".\n    2. You are iterating over a list of tests, and their order changed. Use \"each\" and a custom key prop so that Vest retains their state.`,\n  UNEXPECTED_TEST_REGISTRATION_ERROR = `Unexpected error encountered during test registration.\n      Please report this issue to Vest's Github repository.\n      Test Object: {testObject}.\n      Error: {error}.`,\n  UNEXPECTED_TEST_RUN_ERROR = `Unexpected error encountered during test run. Please report this issue to Vest's Github repository.\n      Test Object: {testObject}.`,\n  INCLUDE_SELF = 'Trying to call include.when on the same field.',\n}\n","import { suiteSelectors } from 'vest';\nimport { hasOwnProperty, invariant, isNullish, isPositive } from 'vest-utils';\n\nimport { ErrorStrings } from 'ErrorStrings';\nimport { SuiteSummary, TFieldName, TGroupName } from 'SuiteResultTypes';\n\nexport function parse<F extends TFieldName, G extends TGroupName>(\n  summary: SuiteSummary<F, G>\n): ParsedVestObject<F> {\n  invariant(\n    summary && hasOwnProperty(summary, 'valid'),\n    ErrorStrings.PARSER_EXPECT_RESULT_OBJECT\n  );\n\n  const sel = suiteSelectors(summary);\n\n  const testedStorage: Record<string, boolean> = {};\n\n  const selectors = {\n    invalid: sel.hasErrors,\n    pending: sel.isPending,\n    tested: isTested,\n    untested: isUntested,\n    valid: sel.isValid,\n    warning: sel.hasWarnings,\n  };\n\n  return selectors;\n\n  // Booleans\n  function isTested(fieldName?: F): boolean {\n    if (isNullish(fieldName)) {\n      return isPositive(summary.testCount);\n    }\n\n    if (hasOwnProperty(testedStorage, fieldName)) {\n      return testedStorage[fieldName];\n    }\n\n    addFieldToTestedStorage(fieldName);\n\n    return selectors.tested(fieldName);\n  }\n\n  function addFieldToTestedStorage(fieldName: F): void {\n    testedStorage[fieldName] =\n      hasOwnProperty(summary.tests, fieldName) &&\n      isPositive(summary.tests[fieldName].testCount);\n  }\n\n  function isUntested(fieldName?: F): boolean {\n    return !(isPositive(summary.testCount) && selectors.tested(fieldName));\n  }\n}\n\nexport type ParsedVestObject<F extends TFieldName> = {\n  valid(fieldName?: F): boolean;\n  tested(fieldName?: F): boolean;\n  invalid(fieldName?: F): boolean;\n  untested(fieldName?: F): boolean;\n  warning(fieldName?: F): boolean;\n  pending(fieldName?: F): boolean;\n};\n"],"names":["ErrorStrings","parse","summary","invariant","hasOwnProperty","PARSER_EXPECT_RESULT_OBJECT","sel","suiteSelectors","testedStorage","selectors","invalid","hasErrors","pending","isPending","tested","fieldName","isNullish","isPositive","testCount","addFieldToTestedStorage","untested","valid","isValid","warning","hasWarnings","tests"],"mappings":"gIAAA,IAAYA,ECMN,SAAUC,EACdC,GAEAC,EACED,GAAWE,EAAeF,EAAS,SACnCF,EAAaK,6BAGf,MAAMC,EAAMC,EAAeL,GAErBM,EAAyC,CAAA,EAEzCC,EAAY,CAChBC,QAASJ,EAAIK,UACbC,QAASN,EAAIO,UACbC,OASF,SAAkBC,GAChB,GAAIC,EAAUD,GACZ,OAAOE,EAAWf,EAAQgB,WAG5B,GAAId,EAAeI,EAAeO,GAChC,OAAOP,EAAcO,GAKvB,OAFAI,EAAwBJ,GAEjBN,EAAUK,OAAOC,EACzB,EApBCK,SA4BF,SAAoBL,GAClB,QAASE,EAAWf,EAAQgB,YAAcT,EAAUK,OAAOC,GAC5D,EA7BCM,MAAOf,EAAIgB,QACXC,QAASjB,EAAIkB,aAGf,OAAOf,EAiBP,SAASU,EAAwBJ,GAC/BP,EAAcO,GACZX,EAAeF,EAAQuB,MAAOV,IAC9BE,EAAWf,EAAQuB,MAAMV,GAAWG,UACvC,CAKH,EDrDA,SAAYlB,GACVA,EAAA,oBAAA,0CACAA,EAAA,mBAAA,kDACAA,EAAA,oBAAA,4BACAA,EAAA,wCAAA,4CACAA,EAAA,2BAAA,gDACAA,EAAA,4BAAA,2EACAA,EAAA,8BAAA,8DACAA,EAAA,iCAAA,sCACAA,EAAA,iCAAA,yFACAA,EAAA,gCAAA,wZAMAA,EAAA,mCAAA,+KAIAA,EAAA,0BAAA,wIAEAA,EAAA,aAAA,gDACD,CAvBD,CAAYA,IAAAA,EAuBX,CAAA"}